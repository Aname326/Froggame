<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hit The Notes!</title>
    <link rel="stylesheet" href="gameplay2.css">
    <link rel="icon" href="tabicon.jpeg">

</head>
<body>

<a href="menu.html" id="menupage">
    <button class="buttonreturn"></button>
</a>
<!--return button that leads to menu page-->

<div id="idInputDiv">
    <h2>Please enter your user ID</h2>
    <input id="idInput">
    <button id="confirmID">confirm</button>
</div>

<div id="game">
    <h1 id="scoreShow">Score: 0</h1>


    <img src="frog-singing-ingame.png" class="singingfrog">
    <img src="Iancursed2.png" class="cursedcharacter">
    <!-- both characters in the right place-->


    <div class="arrows">
            <img src="leftArrow.PNG" id="leftArrow">
            <img src="upArrow.PNG" id="upArrow">
            <img src="downArrow.PNG" id="downArrow">
            <img src="rightArrow.PNG" id="rightArrow">
    </div>
</div>

</body>

<script type="module">
    document.addEventListener('keyup',(event) => {
        var menu = event.key;


        if (menu == "a") {
            open('menu.html')
        } 
        else if (menu == "A") {
            open('menu.html')
        }
    })
    // when press "a" or "A" it opens menu page in a new tab


    // firebase copy and paste codes for setup

     // Import the functions you need from the SDKs you need
     import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.3/firebase-app.js";
     // TODO: Add SDKs for Firebase products that you want to use
     // https://firebase.google.com/docs/web/setup#available-libraries
 
     // Your web app's Firebase configuration
     const firebaseConfig = {
     apiKey: "AIzaSyDKvV1UJgnMr0i9VRCaIrcG_OSgmhpDAZc",
     authDomain: "real-frog-game-2.firebaseapp.com",
     databaseURL: "https://real-frog-game-2-default-rtdb.asia-southeast1.firebasedatabase.app",
     projectId: "real-frog-game-2",
     storageBucket: "real-frog-game-2.appspot.com",
     messagingSenderId: "596703894774",
     appId: "1:596703894774:web:754cd69024da09c1ed20d7"
     };
 
     // Initialize Firebase
     const app = initializeApp(firebaseConfig);
 
    import {getDatabase, set, get, update, remove, ref, child, push}
    from "https://www.gstatic.com/firebasejs/9.9.3/firebase-database.js"
 
    const db = getDatabase();
 
     // firebase setup code ends here

    var game = document.getElementById("game")
    var confirmID = document.getElementById("confirmID")
    var idInput = document.getElementById("idInput")
    var idInputDiv = document.getElementById("idInputDiv")
    var userID
    var upArrow = document.getElementById("upArrow")
    var downArrow = document.getElementById("downArrow")
    var leftArrow = document.getElementById("leftArrow")
    var rightArrow = document.getElementById("rightArrow")
    window.arrowLit = 0
    let arrowList = [upArrowGame, downArrowGame, leftArrowGame, rightArrowGame]
    let listLen = arrowList.length
    var score = 0
    var scoreShow = document.getElementById("scoreShow")
    

    const dbref = ref(db)


    game.style.display = "none"


    function upArrowGame() {
        upArrow.style.boxShadow = "0px 0px 30px blue";
        downArrow.style.boxShadow = "none"
        leftArrow.style.boxShadow = "none"
        rightArrow.style.boxShadow = "none"
        window.arrowLit = 1
    }

    function downArrowGame() {
        downArrow.style.boxShadow = "0px 0px 30px blue";
        upArrow.style.boxShadow = "none"
        leftArrow.style.boxShadow = "none"
        rightArrow.style.boxShadow = "none"
        window.arrowLit = 2
    }

    function leftArrowGame() {
        leftArrow.style.boxShadow = "0px 0px 30px blue";
        downArrow.style.boxShadow = "none"
        upArrow.style.boxShadow = "none"
        rightArrow.style.boxShadow = "none"
        window.arrowLit = 3
    }

    function rightArrowGame() {
        rightArrow.style.boxShadow = "0px 0px 30px blue";
        downArrow.style.boxShadow = "none"
        leftArrow.style.boxShadow = "none"
        upArrow.style.boxShadow = "none"
        window.arrowLit = 4
    }


    function randomNum() {
        return Math.floor( Math.random() * 4);
    }


    function start() {

        if (idInput.value == "" | idInput.value == null) {
            alert("Please enter your user ID")
        } else {
            get(child(dbref, "Users/" + idInput.value))
            .then((snapshot) => {
                if (snapshot.exists()) {
                    game.style.display = "block"
                    idInputDiv.style.display = "none"
                    var userID = idInput.value
                    arrowList[randomNum(listLen)]()
                    
                }
            })
            
        }
        
    }

    confirmID.addEventListener('click', start)

  

    document.addEventListener('keydown',(game) => {
        var arrow = game.key;

        if (arrow == "ArrowLeft") {
            if (window.arrowLit == 3) {
                score += 1
                arrowList[randomNum(listLen)]()
                scoreShow.innerHTML = "Score: " + score
            } else {
                arrowList[randomNum(listLen)]()
            }
        } 
        else if (arrow == "ArrowRight") {
            if (window.arrowLit == 4) {
                score += 1
                arrowList[randomNum(listLen)]()
                scoreShow.innerHTML = "Score: " + score
            } else {
                arrowList[randomNum(listLen)]()
            }
        } 
        else if (arrow == "ArrowUp") {
            if (window.arrowLit == 1) {
                score += 1
                arrowList[randomNum(listLen)]()
                scoreShow.innerHTML = "Score: " + score
            } else {
                arrowList[randomNum(listLen)]()
            }
        } 
        else if (arrow == "ArrowDown") {
            if (window.arrowLit == 2) {
                score += 1
                arrowList[randomNum(listLen)]()
                scoreShow.innerHTML = "Score: " + score
            } else {
                arrowList[randomNum(listLen)]()
            }
        }
        
    })
</script>


</html>